name: Daily Robot Catalog Parser

on:
  schedule:
    # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC (07:00–ø–æ –°–∞—Ä–∞—Ç–æ–≤—É, GMT+4)
    - cron: '0 3 * * *'
  
  # –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é
  workflow_dispatch:

jobs:
  parse-robot-catalog:
    runs-on: ubuntu-latest
    
    steps:
      - name: ü§ñ Parse Robot Catalog via Rube (Optimized)
        run: |
          echo "üöÄ Starting optimized robot catalog parser..."
          echo "üéØ Using new recipe: rcp_5ajueyVK76BF"
          echo "‚ö° Parallelism: 10 workers"
          echo "üè≠ Manufacturers: 24"
          
          curl -X POST "https://backend.composio.dev/api/v3/recipes/rcp_5ajueyVK76BF/execute" \
            -H "Content-Type: application/json" \
            -H "X-API-Key: ${{ secrets.COMPOSIO_API_KEY }}" \
            -d '{
              "input_data": {
                "api_key": "prorobotov2024",
                "api_url": "https://robototehnika.vercel.app/api/robots",
                "search_mode": "all",
                "max_robots_per_manufacturer": "all"
              }
            }' | jq '.data.data'
          
          echo ""
          echo "‚úÖ Robot catalog parsing completed!"
      
      - name: ìåä Summary
        run: |
          echo "üéâ Daily robot catalog update finished!"
          echo "üî® New optimized recipe: 21+ manufacturers, 100+robots!"
          echo "Check: https://robototehnika.vercel.app/api/robots"
