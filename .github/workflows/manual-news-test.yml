name: Manual News Publish

on:
  workflow_dispatch:

jobs:
  manual-publish-news:
    runs-on: ubuntu-latest

    steps:
      - name: Post new (test) news to site
        run: |
          echo "üöÄ Start manual news publish"

          NEXT_TITLE="–¢–µ—Å—Ç Rube $(date +%H:%M:%S) ‚Äî –≤—Å–µ–≥–¥–∞ —Å–≤–µ–∂–∞—è –∑–∞–ø–∏—Å—å"
          NEXT_CONTENT="–ê–≤—Ç–æ-–Ω–æ–≤–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è. –ï—Å–ª–∏ —Ç—ã –µ—ë –≤–∏–¥–∏—à—å ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!"
          IMAGE_URL="https://cdn.pixabay.com/photo/2017/02/20/18/03/cat-2083492_1280.jpg"

          RESPONSE=$(curl -s -X POST "https://robototehnika.vercel.app/api/news" \
            -H "Content-Type: application/json" \
            -H "X-API-Key: prorobotov2024" \
            -d "{
              \"title\": \"$NEXT_TITLE\",
              \"content\": \"$NEXT_CONTENT\",
              \"image_url\": \"$IMAGE_URL\",
              \"published\": true,
              \"short_description\": \"Auto-news –æ—Ç Rube ‚Äî –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!\"
            }")
          
          echo "Site response:"
          echo "$RESPONSE"
          echo "‚úÖ Finished manual publish"
